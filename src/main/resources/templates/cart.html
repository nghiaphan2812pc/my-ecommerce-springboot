<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<!-- Mirrored from themepure.net/template/outstock-prv/outstock/cart.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 05 Aug 2021 13:07:51 GMT -->

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Outstock - Clean, Minimal eCommerce HTML5 Template </title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Place favicon.ico in the root directory -->
  <link rel="shortcut icon" type="image/x-icon" th:href="@{/img/favicon.png}">

  <!-- CSS here -->
  <link rel="stylesheet" th:href="@{/css/preloader.css}">
  <link rel="stylesheet" th:href="@{/css/bootstrap.min.css}">
  <link rel="stylesheet" th:href="@{/css/slick.css}">
  <link rel="stylesheet" th:href="@{/css/metisMenu.css}">
  <link rel="stylesheet" th:href="@{/css/owl.carousel.min.css}">
  <link rel="stylesheet" th:href="@{/css/animate.min.css}">
  <link rel="stylesheet" th:href="@{/css/ui-range-slider.css}">
  <link rel="stylesheet" th:href="@{/css/jquery.fancybox.min.css}">
  <link rel="stylesheet" th:href="@{/css/fontAwesome5Pro.css}">
  <link rel="stylesheet" th:href="@{/css/ionicons.min.css}">
  <link rel="stylesheet" th:href="@{/css/default.css}">
  <link rel="stylesheet" th:href="@{/css/style.css}">
</head>

<body>
  <!--[if lte IE 9]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
        <![endif]-->

  <!-- Add your site or application content here -->

  <!-- prealoder area start -->
  <div id="loading">
    <div id="loading-center">
      <div id="loading-center-absolute">
        <div class="object" id="first_object"></div>
        <div class="object" id="second_object"></div>
        <div class="object" id="third_object"></div>
      </div>
    </div>
  </div>
  <!-- prealoder area end -->

  <!-- header area start -->
  <header th:replace="fragments/header :: header"></header>
  <!-- header area end -->

  <!-- scroll up area start -->
  <div class="scroll-up" id="scroll" style="display: none;">
    <a href="javascript:void(0);"><i class="fas fa-level-up-alt"></i></a>
  </div>
  <!-- scroll up area end -->

  <!-- search area start -->
  <section th:replace="fragments/search :: search"></section>
  <div class="body-overlay transition-3"></div>
  <!-- search area end -->

  <!-- extra info area start -->
  <section class="extra__info transition-3">
    <div class="extra__info-inner">
      <div class="extra__info-close text-right">
        <a href="javascript:void(0);" class="extra__info-close-btn"><i class="fal fa-times"></i></a>
      </div>
      <!-- side-mobile-menu start -->
      <nav th:replace="fragments/sideMobileMenu:: sideMobileMenu"></nav>
      <!-- side-mobile-menu end -->
    </div>
  </section>
  <div class="body-overlay transition-3"></div>
  <!-- extra info area end -->
  <main>
    <!-- page title area start -->
    <section class="page__title p-relative d-flex align-items-center" data-background="../img/page-title/cover-3.jpeg">
      <div class="container">
        <div class="row">
          <div class="col-xl-12">
            <div class="page__title-inner text-center">
              <h1  style="color:whitesmoke;">Your Cart</h1>
              <div class="page__title-breadcrumb">
                <nav aria-label="breadcrumb">
                  <ol class="breadcrumb justify-content-center">
                    <li  style="color:whitesmoke;" class="breadcrumb-item"><a th:href="@{/index}">Home</a></li>
                    <li  style="color:whitesmoke;" class="breadcrumb-item active" aria-current="page"> Cart</li>
                  </ol>
                </nav>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- page title area end -->

    <!-- Cart Area Strat-->
    <section class="cart-area pt-100 pb-100">
      <div class="container">
        <div class="row">
          <div class="col-12">
            <form action="#">
              <div class="table-content table-responsive">
                <table class="table">
                  <thead>
                    <tr>
                      <th class="product-thumbnail">Images</th>
                      <th class="cart-product-name">Product</th>
                      <th class="product-price">Unit Price</th>
                      <th class="product-quantity">Quantity</th>
                      <th class="product-subtotal">Total</th>
                      <th class="product-remove">Remove</th>
                    </tr>
                  </thead>
                  <tbody id="list-product-in-cart">
                  </tbody>
                </table>
              </div>
              <div class="row">
                <div class="col-12">
                  <div class="coupon-all">
                    <div class="coupon2">
                      <a th:href="@{/index}"><button class="os-btn os-btn-black" name="update_cart" type="button">Continue shopping</button></a>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-md-5 ml-auto">
                  <div class="cart-page-total">
                    <h2>Cart totals</h2>
                    <ul class="mb-20">
                      <li>Subtotal <span id="subtotal">$250.00</span></li>
                      <li>Total <span id = "total">$250.00</span></li>
                    </ul>
                    <a class="os-btn" th:href="@{/checkout}">Proceed to checkout</a>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </section>
    <!-- Cart Area End-->
  </main>


  <!-- footer area start -->
  <section th:replace="fragments/footer :: footer"></section>
  <!-- footer area end -->

  <!-- JS here -->
  <script th:src="@{/js/vendor/modernizr-3.5.0.min.js}"></script>
  <script th:src="@{/js/vendor/jquery-3.5.1.min.js}"></script>
<!--  <script th:src="@{/js/vendor/waypoints.min.js}"></script>-->
  <script th:src="@{/js/bootstrap.bundle.min.js}"></script>
  <script th:src="@{/js/metisMenu.min.js}"></script>
  <script th:src="@{/js/slick.min.js}"></script>
  <script th:src="@{/js/jquery.fancybox.min.js}"></script>
  <script th:src="@{/js/isotope.pkgd.min.js}"></script>
  <script th:src="@{/js/owl.carousel.min.js}"></script>
  <script th:src="@{/js/jquery-ui-slider-range.js}"></script>
  <script th:src="@{/js/ajax-form.js}"></script>
  <script th:src="@{/js/wow.min.js}"></script>
  <script th:src="@{/js/imagesloaded.pkgd.min.js}"></script>
  <script th:src="@{/js/main.js}"></script>
  <script>
    getCart(userID)
    function getCart(userID){
      if(userID == null){
        window.location.replace(preUrl + "/login");
      }
      $.ajax({
        url: preUrl + "/getCart/" + userID,
        type: "GET",
        success: function (response) {
          console.log(response);
          if(response.code == 200){
            renderCart(response.data);
          }else if(response.code == 403){
            window.location.replace(preUrl + "/login");
          }
        }
      })
    }
    var totalPrice = 0;
    function renderCart(cart) {
      totalPrice = 0;
      $('#list-product-in-cart').empty();
      cart.map(item => {
        $('#list-product-in-cart').append(`<tr id="product-${item.product.id}">
                      <td class="product-thumbnail"><a href="product-details.html"><img src="../img/${item.product.imageList[0].image}" alt=""></a></td>
                      <td class="product-name"><a href="product-details.html">${item.product.name}</a></td>
                      <td class="product-price"><span class="amount">${moneyFormat.format(item.product.price)}</span></td>
                      <td class="product-quantity">
                      <div class="cart-plus-minus"><input id="product-quantity-${item.product.id}" onchange="updateProductQuantityInCart(userID,${item.product.id})" type="text" value="${item.quantity}"><div class="dec qtybutton" onclick="updateProductInCart(userID, ${item.product.id},-1,${item.product.price})">-</div><div class="inc qtybutton" onclick="updateProductInCart(userID, ${item.product.id},1,${item.product.price})">+</div></div>
                      </td>
                      <td class="product-subtotal"><span id="product-total-${item.product.id}" class="amount">${moneyFormat.format(item.product.price * item.quantity)}</span></td>
                      <td class="product-remove"><i class="fa fa-times" onclick="removeProductFromCart(userID, ${item.product.id}, ${item.product.price})"></i></td>
                    </tr>`);
        totalPrice += item.product.price * item.quantity;
      });
      updateSubtotalAndTotal(totalPrice);
    }
    function updateProductInCart(userID, productID, flag, price){
      if(userID == null){
        window.location.replace(preUrl + "/login");
      }
      quantityValue = parseInt($("#product-quantity-"+productID).val()) + flag
      let request = {
        userID: userID,
        productID: productID,
        quantity: quantityValue
      }
      $.ajax({
        url:preUrl + "/updateProductInCart",
        type: "POST",
        data: JSON.stringify(request),
        contentType: "application/json",
        success: function (response){
          console.log("response", response);
          if(response.code == 200) {
            $("#product-quantity-" + productID).val(quantityValue);
            $("#product-total-" + productID).html(moneyFormat.format(quantityValue * price));
            totalPrice = totalPrice + flag * price;
            updateSubtotalAndTotal(totalPrice);
            if (quantityValue == 0) $("#product-" + productID).remove();
            getMiniCart(userID);
          }else if(response.code == 403){
            window.location.replace(preUrl + "/login");
          }
        }
      })
    }
    function updateProductQuantityInCart(userID, productID){
      if(userID == null){
        window.location.replace(preUrl + "/login");
      }
      let request = {
        userID: userID,
        productID: productID,
        quantity: parseInt($("#product-quantity-"+productID).val())
      }
      $.ajax({
        url:preUrl + "/updateProductInCart",
        type: "POST",
        data: JSON.stringify(request),
        contentType: "application/json",
        success: function (response){
          console.log("response", response);
          if(response.code == 200) {
            getCart(userID);
            getMiniCart(userID);
          }else if (response.code == 403){
            window.location.replace(preUrl + "/login");
          }
        }
      })
    }
    function removeProductFromCart(userID, productID,price){
      if(userID == null){
        window.location.replace(preUrl + "/login");
      }
      let request = {
        userID: userID,
        productID: productID,
        quantity: 0
      }
      quantityValue = parseInt($("#product-quantity-"+productID).val())
      $.ajax({
        url:preUrl + "/removeProductFromCart",
        type: "POST",
        data: JSON.stringify(request),
        contentType: "application/json",
        success: function (response){
          console.log("response", response);
          if(response.code == 200) {
            totalPrice = totalPrice - quantityValue * price;
            $("#product-" + productID).remove();
            updateSubtotalAndTotal(totalPrice);
            getMiniCart(userID);
          }else if(response.code ==403){
            window.location.replace(preUrl + "/login");
          }
        }
      });
    }
    function updateSubtotalAndTotal(totalPrice){
      totalPrice = moneyFormat.format(totalPrice);
      $('#subtotal').html(totalPrice + " VND");
      $('#total').html(totalPrice + " VND");
    }
  </script>


</body>

<!-- Mirrored from themepure.net/template/outstock-prv/outstock/cart.html by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 05 Aug 2021 13:07:51 GMT -->
</html>
